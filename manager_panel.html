<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ - Volt Logistics</title>
    <link rel="stylesheet" href="style.css">
    <script src="js/common.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        .manager-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #141414;
            color: white;
            min-height: 100vh;
        }

        .manager-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .manager-title {
            font-size: 28px;
            font-weight: bold;
            color: #FF6B35;
            margin: 0;
        }

        .manager-subtitle {
            font-size: 16px;
            color: #888;
            margin: 10px 0 0 0;
        }

        .manager-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid #FF6B35;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #FF6B35;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: #ccc;
        }

        .manager-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .action-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: transform 0.2s ease;
        }

        .action-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.12);
        }

        .action-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .action-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #FF6B35;
        }

        .action-description {
            font-size: 14px;
            color: #ccc;
            margin-bottom: 15px;
        }

        .action-button {
            background: #FF6B35;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            width: 100%;
        }

        .action-button:hover {
            background: #E55A2B;
            transform: translateY(-1px);
        }

        .orders-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #FF6B35;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .orders-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-select {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 14px;
            min-width: 150px;
        }

        .filter-select:focus {
            outline: none;
            border-color: #FF6B35;
        }

        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .order-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--status-color, #888);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .order-id {
            font-weight: bold;
            font-size: 16px;
            color: #FF6B35;
        }

        .order-date {
            color: #888;
            font-size: 14px;
        }

        .status-select {
            background: var(--status-color, #888);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            font-weight: bold;
        }

        .order-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .detail-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
        }

        .detail-label {
            color: #888;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .detail-value {
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #888;
        }

        .error {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid #E74C3C;
            color: #E74C3C;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .manager-container {
                padding: 15px;
            }

            .manager-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .manager-actions {
                grid-template-columns: 1fr;
            }

            .orders-filters {
                flex-direction: column;
            }

            .order-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>

<body>
    <div class="manager-container">
        <div class="manager-header">
            <h1 class="manager-title">üë®‚Äçüíº –ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞</h1>
            <p class="manager-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã</p>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="manager-stats" id="statsContainer">
            <div class="stat-card">
                <div class="stat-number" id="totalOrders">-</div>
                <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingOrders">-</div>
                <div class="stat-label">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedOrders">-</div>
                <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalItems">-</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
            </div>
        </div>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="manager-actions">
            <div class="action-card">
                <div class="action-icon">üì¶</div>
                <div class="action-title">–í—Å–µ –∑–∞–∫–∞–∑—ã</div>
                <div class="action-description">–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –∑–∞–∫–∞–∑–∞–º–∏</div>
                <button class="action-button" onclick="window.location.href='manager_orders.html'">–û—Ç–∫—Ä—ã—Ç—å</button>
            </div>

            <div class="action-card">
                <div class="action-icon">üîÑ</div>
                <div class="action-title">–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
                <div class="action-description">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –∑–∞–∫–∞–∑—ã</div>
                <button class="action-button" onclick="refreshData()">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>

            <div class="action-card">
                <div class="action-icon">üß™</div>
                <div class="action-title">–¢–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã</div>
                <div class="action-description">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                <button class="action-button" onclick="window.location.href='manager_test.html'">–¢–µ—Å—Ç—ã</button>
            </div>

            <div class="action-card">
                <div class="action-icon">üìä</div>
                <div class="action-title">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑</div>
                <div class="action-description">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</div>
                <button class="action-button" onclick="createTestOrder()">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>

        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã -->
        <div class="orders-section">
            <div class="section-title">
                üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã
                <button class="action-button" onclick="refreshOrders()" style="width: auto; margin-left: auto;">üîÑ
                    –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>

            <div class="orders-filters">
                <select class="filter-select" id="statusFilter" onchange="filterOrders()">
                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                </select>
                <select class="filter-select" id="limitFilter" onchange="filterOrders()">
                    <option value="10">–ü–æ–∫–∞–∑–∞—Ç—å 10</option>
                    <option value="20">–ü–æ–∫–∞–∑–∞—Ç—å 20</option>
                    <option value="50">–ü–æ–∫–∞–∑–∞—Ç—å 50</option>
                </select>
            </div>

            <div class="orders-list" id="ordersContainer">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</div>
            </div>
        </div>
    </div>

    <!-- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è SVG-–∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" -->
    <button class="back-button show" onclick="goBack()" aria-label="–ù–∞–∑–∞–¥"></button>

    <script>
        let allOrders = [];
        let orderStatuses = {};

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–Ω–µ–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
        async function initManagerPanel() {
            console.log('üë®‚Äçüíº –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–Ω–µ–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
            if (!isManager()) {
                showError('–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞');
                return;
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            await loadOrderStatuses();
            await loadStats();
            await loadRecentOrders();

            console.log('‚úÖ –ü–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤
        async function loadOrderStatuses() {
            try {
                const response = await fetch('http://localhost:5000/api/orders/statuses');
                const data = await response.json();

                if (data.status === 'success') {
                    data.statuses.forEach(status => {
                        orderStatuses[status.id] = status;
                    });

                    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä —Å—Ç–∞—Ç—É—Å–æ–≤
                    const statusFilter = document.getElementById('statusFilter');
                    data.statuses.forEach(status => {
                        const option = document.createElement('option');
                        option.value = status.id;
                        option.textContent = status.name;
                        statusFilter.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function loadStats() {
            try {
                const response = await fetch('http://localhost:5000/api/orders/all');
                const data = await response.json();

                if (data.status === 'success') {
                    const orders = data.orders;

                    // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    const totalOrders = orders.length;
                    const pendingOrders = orders.filter(order => order.status === 'pending').length;
                    const completedOrders = orders.filter(order => order.status === 'delivered').length;
                    const totalItems = orders.reduce((sum, order) => sum + (order.total_items || 0), 0);

                    // –û–±–Ω–æ–≤–ª—è–µ–º UI
                    document.getElementById('totalOrders').textContent = totalOrders;
                    document.getElementById('pendingOrders').textContent = pendingOrders;
                    document.getElementById('completedOrders').textContent = completedOrders;
                    document.getElementById('totalItems').textContent = totalItems;
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                document.getElementById('totalOrders').textContent = '?';
                document.getElementById('pendingOrders').textContent = '?';
                document.getElementById('completedOrders').textContent = '?';
                document.getElementById('totalItems').textContent = '?';
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–∫–∞–∑–æ–≤
        async function loadRecentOrders() {
            const container = document.getElementById('ordersContainer');
            container.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</div>';

            try {
                const response = await fetch('http://localhost:5000/api/orders/all');
                const data = await response.json();

                if (data.status === 'success') {
                    allOrders = data.orders;
                    displayOrders(allOrders.slice(0, 10)); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10
                } else {
                    showError(data.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤:', error);
                showError('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω.');
            }
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
        function displayOrders(orders) {
            const container = document.getElementById('ordersContainer');

            if (orders.length === 0) {
                container.innerHTML = '<div class="loading">–ó–∞–∫–∞–∑—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            const ordersHTML = orders.map(order => createOrderCard(order)).join('');
            container.innerHTML = ordersHTML;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–∫–∞–∑–∞
        function createOrderCard(order) {
            const status = orderStatuses[order.status] || { name: order.status, color: '#888' };
            const createdDate = new Date(order.created_at).toLocaleDateString('ru-RU');

            return `
                <div class="order-card" style="--status-color: ${status.color}">
                    <div class="order-header">
                        <div>
                            <div class="order-id">${order.order_number ? `–ó–∞–∫–∞–∑ #${order.order_number}` : `ID: ${order.id}`}</div>
                            <div style="font-size: 10px; color: #666;">ID: ${order.id}</div>
                            <div class="order-date">–°–æ–∑–¥–∞–Ω: ${createdDate}</div>
                        </div>
                        <div class="status-display" style="background: ${status.color}; color: white; padding: 8px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; text-align: center;">
                            ${status.name}
                        </div>
                    </div>
                    
                    <div class="order-details">
                        <div class="detail-item">
                            <div class="detail-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                            <div class="detail-value">${order.full_name || order.telegram_username || '–ù–µ —É–∫–∞–∑–∞–Ω'}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–¢–æ–≤–∞—Ä–æ–≤</div>
                            <div class="detail-value">${order.total_items || 0}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</div>
                            <div class="detail-value">${order.total_photos || 0}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–°—Ç—Ä–∞–Ω–∞</div>
                            <div class="detail-value">${order.country || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
        async function updateOrderStatus(orderId, newStatus) {
            try {
                const response = await fetch(`http://localhost:5000/api/orders/${orderId}/status`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        status: newStatus,
                        updated_by: 'manager'
                    })
                });

                const data = await response.json();

                if (data.status === 'success') {
                    console.log(`–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ ${orderId} –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ ${newStatus}`);
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    const order = allOrders.find(o => o.id === orderId);
                    if (order) {
                        order.status = newStatus;
                    }
                    await loadStats(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                } else {
                    alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞: ' + data.message);
                    await loadRecentOrders(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤
        function filterOrders() {
            const statusFilter = document.getElementById('statusFilter').value;
            const limitFilter = parseInt(document.getElementById('limitFilter').value);

            let filteredOrders = allOrders;

            if (statusFilter) {
                filteredOrders = filteredOrders.filter(order => order.status === statusFilter);
            }

            filteredOrders = filteredOrders.slice(0, limitFilter);
            displayOrders(filteredOrders);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        async function refreshData() {
            await loadStats();
            await loadRecentOrders();
            console.log('üîÑ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
        async function refreshOrders() {
            await loadRecentOrders();
            console.log('üîÑ –ó–∞–∫–∞–∑—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞
        async function createTestOrder() {
            const user = getTelegramUser();

            const testOrder = {
                telegram_user_id: user ? user.id : 919034275,
                user_name: user ? `${user.first_name} ${user.last_name || ''}`.trim() : 'Test Manager',
                telegram_username: user ? user.username : 'test_manager',
                full_name: '–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞',
                phone: '+7 (999) 123-45-67',
                country: 'china',
                items: [{
                    link_or_id: 'https://item.taobao.com/item.htm?id=test123',
                    color: '–¢–µ—Å—Ç–æ–≤—ã–π —Ü–≤–µ—Ç',
                    size: 'M',
                    quantity: '1',
                    comment: '–¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä –æ—Ç –ø–∞–Ω–µ–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞',
                    photos: []
                }],
                delivery_address: '–¢–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏',
                comment: '–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞'
            };

            try {
                const response = await fetch('http://localhost:5000/api/orders', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testOrder)
                });

                const result = await response.json();

                if (result.status === 'success') {
                    alert(`‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω!\n\nID: ${result.order_id}`);
                    await refreshData();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞: ' + result.message);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
        function showError(message) {
            const container = document.getElementById('ordersContainer');
            container.innerHTML = `
                <div class="error">
                    <strong>–û—à–∏–±–∫–∞:</strong> ${message}
                    <br><br>
                    <button class="action-button" onclick="refreshOrders()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                </div>
            `;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', initManagerPanel);
    </script>

    <!-- –°—Ç–∏–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" -->
    <button class="stylish-back-button show" onclick="goBack()" aria-label="–ù–∞–∑–∞–¥">
    </button>
</body>

</html>